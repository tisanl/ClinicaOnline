import{b as ie,h as te}from"./chunk-N3MNZNK2.js";import"./chunk-5TYF45X6.js";import"./chunk-FK6H3RFT.js";import{a as re}from"./chunk-GZKUZZRW.js";import{b as z,c as U,e as E,g as $,h as B,i as O,k as p,m as R,n as J,o as q,p as K,q as Q,r as W,s as X,t as Y}from"./chunk-X7ATPYRG.js";import{U as Z,W as ee}from"./chunk-VBHGM43M.js";import{e as V,j as G,q as D,s as L,t as j}from"./chunk-NR3I2YFB.js";import"./chunk-LJ5XHLMQ.js";import{Ab as P,Bb as m,Cb as o,Db as r,Eb as u,Lb as w,Pb as S,Ra as N,Rb as f,Sa as c,ab as d,bc as k,dc as l,ec as g,gb as I,gc as H,ha as M,ia as b,kc as T,oc as C,vb as v,wb as _,xb as A,zb as y}from"./chunk-KP5MESBS.js";import{h}from"./chunk-FK42CRUA.js";var F=n=>({deshabilitado:n}),ne=(n,e)=>e.especialidades.id;function le(n,e){if(n&1&&(o(0,"li"),l(1),r()),n&2){let i=e.$implicit;c(),g(i.especialidades.nombre)}}function se(n,e){n&1&&(o(0,"p",21),l(1,"Horarios invalidos. El horario de fin debe ser mayor a inicio"),r())}function ce(n,e){if(n&1&&(o(0,"div",13)(1,"div",14)(2,"span",15),l(3),r(),o(4,"label",16)(5,"span"),l(6,"Atiende"),r(),u(7,"input",17),r(),o(8,"div",18)(9,"label"),l(10,"Desde"),r(),u(11,"input",19),r(),o(12,"div",18)(13,"label"),l(14,"Hasta"),r(),u(15,"input",20),r()(),v(16,se,2,0,"p",21),r()),n&2){let i,a,t,s=e.$implicit,x=e.$index,ae=f(2);k("activo",s.value.activo)("inactivo",!s.value.activo),m("formGroupName",x),c(3),g(ae.obtenerNombreDia(s.value.dia_semana)),c(8),m("ngClass",C(9,F,((i=s.get("activo"))==null?null:i.value)===!1)),c(4),m("ngClass",C(11,F,((a=s.get("activo"))==null?null:a.value)===!1)),c(),_((t=s.get("activo"))!=null&&t.value&&((t=s.get("hora_inicio"))!=null&&t.touched&&((t=s.get("hora_inicio"))!=null&&t.invalid)&&!((t=s.get("hora_inicio"))!=null&&t.value)||(t=s.get("hora_fin"))!=null&&t.touched&&((t=s.get("hora_fin"))!=null&&t.invalid)&&!((t=s.get("hora_fin"))!=null&&t.value)||s.getError("horarioInvalido")&&((t=s.get("activo"))!=null&&t.value))?16:-1)}}function me(n,e){if(n&1){let i=w();o(0,"div",5)(1,"div",6)(2,"h4"),l(3,"Especialidades"),r(),o(4,"ul"),y(5,le,2,1,"li",null,ne),r()(),o(7,"div",7)(8,"h4"),l(9,"Horarios de Atenci\xF3n"),r(),o(10,"h5"),l(11,"Los horarios son:"),r(),o(12,"h6"),l(13,"Lunes a Viernes: 09:00 a 18:00 hs"),r(),o(14,"h6"),l(15,"S\xE1bados: 09:00 a 14:00 hs"),r(),o(16,"form",8)(17,"div",9),y(18,ce,17,13,"div",10,A),r(),o(20,"div",11)(21,"button",12),S("click",function(){M(i);let t=f();return b(t.guardarHorarios())}),l(22," Guardar cambios "),r()()()()()}if(n&2){let i=f();c(5),P(i.usuario.usuario_especialidad),c(11),m("formGroup",i.horariosForm),c(2),P(i.horariosArray.controls),c(3),m("ngClass",C(2,F,i.horariosForm.dirty===!1))}}function de(n,e){if(n&1){let i=w();o(0,"div")(1,"button",22),S("click",function(){M(i);let t=f();return b(t.verHistoriaClinica())}),l(2,"Ver Mi Historia Clinica"),r()()}}var oe=class n{constructor(e,i,a,t,s){this.u=e;this.sa=i;this.he=a;this.t=t;this.dialog=s}usuario=null;horariosForm;ngOnInit(){return h(this,null,function*(){this.sa.showLoading(),this.usuario=yield this.u.obtenerUsuarioPorId(this.u.userId),this.sa.closeLoading(),this.usuario.perfil==="especialista"&&(this.horariosForm=new O({horarios:new W(this.usuario.horarios_especialista.map(e=>new O({id:new p(e.id),dia_semana:new p(e.dia_semana),activo:new p(e.activo),hora_inicio:new p(e.hora_inicio,[E.pattern("^[0-9]{1,2}$")]),hora_fin:new p(e.hora_fin,[E.pattern("^[0-9]{1,2}$")])},{validators:this.validarHorarioGrupo})))}))})}guardarHorarios(){return h(this,null,function*(){if(this.horariosForm.invalid){yield this.sa.showAlertError("Error en los datos","Revise los datos ingresados");return}this.sa.showLoading();let e=this.horariosArray.controls.map(i=>i.value);try{yield this.he.actualizarHorariosEspecialista(e),this.sa.closeLoading(),yield this.sa.showAlertSuccess("Registro completado!","Los horarios fueron actualizados")}catch(i){this.sa.closeLoading(),yield this.sa.showAlertError("Error en el registro",i.message)}})}get horariosArray(){return this.horariosForm.get("horarios")}validarHorarioGrupo(e){let i=e.get("activo")?.value,a=Number(e.get("hora_inicio")?.value),t=Number(e.get("hora_fin")?.value),s=Number(e.get("dia_semana")?.value);if(!i)return null;if(isNaN(a)||isNaN(t))return{horarioInvalido:!0};let x=s===6?14:18;return a<9||t>x||t<=a?{horarioInvalido:!0}:null}capitalizar(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}obtenerNombreDia(e){return["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"][e]??""}verHistoriaClinica(){return h(this,null,function*(){this.sa.showLoading();let e=yield this.t.obtenerTurnosFinalizadosPaciente(this.u.userId);this.sa.closeLoading(),console.log(e);let i=this.dialog.open(te,{data:{turnos:e}})})}static \u0275fac=function(i){return new(i||n)(d(j),d(L),d(D),d(re),d(ie))};static \u0275cmp=I({type:n,selectors:[["app-mi-perfil"]],decls:14,vars:9,consts:[[1,"card-container","anim-entrar-derecha"],[1,"titulo-perfil"],[1,"perfil-header"],[1,"perfil-foto",3,"src","alt"],[1,"perfil-datos"],[1,"perfil-especialista"],[1,"perfil-especialista-header"],[1,"perfil-especialista-horarios"],[3,"formGroup"],["formArrayName","horarios",1,"lista-horarios"],[1,"horario-item",3,"formGroupName","activo","inactivo"],[1,"especialista-botones"],[1,"btn-1",3,"click","ngClass"],[1,"horario-item",3,"formGroupName"],[1,"horario-fila"],[1,"dia"],[1,"check-atiende"],["type","checkbox","formControlName","activo"],[1,"input"],["formControlName","hora_inicio",3,"ngClass"],["formControlName","hora_fin",3,"ngClass"],[1,"error-msg"],["matButton","filled",2,"min-width","40px","max-width","255px","height","40px",3,"click"]],template:function(i,a){i&1&&(o(0,"main",0)(1,"h2",1),l(2,"Mi Perfil"),r(),o(3,"div",2),u(4,"img",3),o(5,"div",4)(6,"h3"),l(7),r(),o(8,"p"),l(9),r(),o(10,"p"),l(11),r()()(),v(12,me,23,4,"div",5),v(13,de,3,0,"div"),r()),i&2&&(c(4),m("alt",T(a.usuario.nombre))("src",a.usuario.imagen_1_path,N),c(3),H("",a.capitalizar(a.usuario.nombre)," ",a.usuario.apellido),c(2),g(a.usuario.email),c(2),g(a.capitalizar(a.usuario.perfil)),c(),_(a.usuario.perfil==="especialista"?12:-1),c(),_(a.usuario.perfil==="paciente"?13:-1))},dependencies:[G,V,X,R,U,z,$,B,Y,J,Q,q,K,ee,Z],styles:["[_nghost-%COMP%]     .card-container{width:400vh}.titulo-perfil[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;color:var(--c-accent)}.perfil-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;border-bottom:1px solid var(--c-primary-dark);padding-bottom:1rem}.perfil-foto[_ngcontent-%COMP%]{width:120px;height:120px;object-fit:cover;border-radius:50%;border:3px solid var(--c-primary)}.perfil-datos[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--c-primary-light)}.perfil-datos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;color:var(--c-accent)}.perfil-especialista-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.25rem;border-bottom:1px solid var(--c-primary-dark)}.perfil-especialista[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:.5rem;color:var(--c-primary)}.perfil-especialista[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--c-accent)}.perfil-especialista[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:var(--c-primary-light)}.perfil-especialista[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:disc;padding-left:1.5rem;margin-top:.5rem}.perfil-especialista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--c-primary-light)}.perfil-especialista-horarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem}.lista-horarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.horario-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:var(--c-neutral);padding:.8rem 1rem;border-radius:6px;border-left:4px solid transparent;transition:background .3s ease,border-left-color .3s ease}.horario-fila[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:2rem}.perfil-especialista[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--c-accent)}.horario-item.activo[_ngcontent-%COMP%]{background-color:#00968826;border-left-color:var(--c-primary)}.horario-item.inactivo[_ngcontent-%COMP%]{background-color:#ff000026;border-left-color:#e57373}.fila-horario[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.dia[_ngcontent-%COMP%]{width:75px;font-weight:600;color:var(--c-primary-light)}.check-atiende[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.3rem;color:var(--c-primary)!important;font-weight:600}.input[_ngcontent-%COMP%]{width:100px;display:flex;flex-direction:row!important;align-items:flex-end!important;gap:10px}.horas-con-error[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center}.error-msg[_ngcontent-%COMP%]{color:#e57373;font-size:.85rem;margin:.25rem 0 0 .25rem}.especialista-botones[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:.5rem}.deshabilitado[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;cursor:not-allowed}"]})};export{oe as MiPerfil};
