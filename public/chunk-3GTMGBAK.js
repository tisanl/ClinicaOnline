import{a as B}from"./chunk-SZDQ2YDS.js";import{c as q,e as o,g as G,h as D,i as y,k as m,m as z,n as U,q as $,s as j,t as Z}from"./chunk-H2UFVKJY.js";import{b as F}from"./chunk-2UEFWIHA.js";import"./chunk-CP6NELDM.js";import{e as M,j as O,p as V,s as L,t as I}from"./chunk-UGTTAIU5.js";import"./chunk-LJ5XHLMQ.js";import{Ab as x,Bb as h,Cb as t,Db as a,Eb as p,Lb as C,Pb as g,Rb as v,Sa as n,ab as f,ac as c,bc as k,dc as l,ec as R,gb as N,ha as _,ia as E,oc as A,vb as w,wb as P,zb as T}from"./chunk-KP5MESBS.js";import{h as b}from"./chunk-FK42CRUA.js";var Y=d=>({deshabilitado:d}),J=(d,r)=>r.id;function K(d,r){if(d&1){let i=C();t(0,"form",2)(1,"div",3)(2,"label"),l(3,"Obra Social"),a(),p(4,"input",21),t(5,"small"),l(6," La obra social es obligatoria. "),a()(),t(7,"div",3)(8,"label"),l(9,"Imagen 2"),a(),t(10,"input",10),g("change",function(s){_(i);let u=v();return u.onFileSelected(s,"imagen2"),E(u.imagen2==null?null:u.imagen2.markAsTouched())}),a(),t(11,"small"),l(12," La imagen es obligatoria. "),a()()()}if(d&2){let i=v();h("formGroup",i.formPaciente),n(5),c("visibility",i.obraSocial!=null&&i.obraSocial.invalid&&(i.obraSocial!=null&&i.obraSocial.touched)?"visible":"hidden"),n(6),c("visibility",i.imagen2!=null&&i.imagen2.invalid&&(i.imagen2!=null&&i.imagen2.touched)?"visible":"hidden")}}function Q(d,r){if(d&1){let i=C();t(0,"label",23)(1,"input",26),g("change",function(s){let u=_(i).$implicit,S=v(2);return E(S.onToggleEspecialidad(u.id,s))}),a(),t(2,"span"),l(3),a()()}if(d&2){let i=r.$implicit;n(),h("value",i.id),n(2),R(i.nombre)}}function W(d,r){if(d&1){let i=C();t(0,"form",2)(1,"div",3)(2,"label"),l(3,"Especialidades"),a(),t(4,"div",22),T(5,Q,4,2,"label",23,J),a(),t(7,"small"),l(8," Debe seleccionar al menos una especialidad. "),a()(),t(9,"div",3)(10,"label"),l(11,"Nueva Especialidad"),a(),p(12,"input",24),t(13,"small"),l(14," La especialidad solo debe contener caracteres alfabeticos y espacios. "),a(),t(15,"button",25),g("click",function(){_(i);let s=v();return E(s.agregarEspecialidad())}),l(16," Agregar Especialidad "),a()()()}if(d&2){let i=v();h("formGroup",i.formEspecialista),n(5),x(i.especialidades),n(2),c("visibility",i.especialidadesChecks!=null&&i.especialidadesChecks.invalid&&(i.especialidadesChecks!=null&&i.especialidadesChecks.touched)?"visible":"hidden"),n(6),c("visibility",i.especialidadNueva!=null&&i.especialidadNueva.invalid?"visible":"hidden"),n(2),h("ngClass",A(6,Y,!(i.especialidadNueva!=null&&i.especialidadNueva.value)||(i.especialidadNueva==null?null:i.especialidadNueva.invalid)))}}var H=class d{constructor(r,i,e,s){this.router=r;this.u=i;this.e=e;this.sa=s}form;formPaciente;formEspecialista;especialidades=[];ngOnInit(){return b(this,null,function*(){this.form=new y({email:new m(null,[o.required,o.email]),password:new m(null,[o.required,o.minLength(6)]),nombre:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),apellido:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),dni:new m(null,[o.required,o.pattern("^[0-9]{8,9}$")]),edad:new m(null,[o.required,o.pattern("^[0-9]{1,2}$"),o.min(18),o.max(120)]),imagen1:new m(null,o.required),perfil:new m(null,o.required),captcha:new m("",o.required)}),this.formPaciente=new y({obraSocial:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),imagen2:new m(null,o.required)}),this.formEspecialista=new y({especialidadesChecks:new m(null,o.required),especialidadNueva:new m(null,[o.pattern("^[a-zA-Z ]+$")])}),console.log(this.especialidadNueva),this.especialidades=yield this.e.obtenerEspecialidades()})}registrarUsuario(){return b(this,null,function*(){if(this.form.invalid&&(this.formPaciente.invalid||this.formEspecialista.invalid)){console.log(this.form),this.form.markAllAsTouched(),this.formPaciente.markAllAsTouched(),this.formEspecialista.markAllAsTouched(),yield this.sa.showAlertError("Error en los datos","Revise los datos ingresados");return}this.sa.showLoading();let r={id:"",created_at:null,email:this.email.value,nombre:this.capitalizar(this.nombre?.value),apellido:this.capitalizar(this.apellido?.value),dni:this.dni.value,edad:this.edad.value,obra_social:this.obraSocial.value,imagen_1_path:null,imagen_2_path:null,imagen_1_file:this.imagen1.value,imagen_2_file:this.imagen2.value,perfil:this.perfil.value,estado:null,historia_clinica_id:null,lista_especialidades_id:this.especialidadesChecks.value,usuario_especialidad:null,horarios_especialista:null};try{yield this.u.registrar(this.email?.value,this.password?.value,r),this.sa.closeLoading(),r.perfil=="especialista"?(this.u.logout(),yield this.sa.showAlertSuccess("Registro completado!","Seras enviado al Login. Recorda validar tu mail antes de ingresar y que un Aministrador debe habilitarte")):yield this.sa.showAlertSuccess("Registro completado!","Seras enviado al Login. Recorda validar tu mail antes de ingresar"),this.goTo("login")}catch(i){this.sa.closeLoading(),yield this.sa.showAlertError("Error en el registro",i.message)}})}agregarEspecialidad(){return b(this,null,function*(){if(!this.especialidadNueva.value)return;this.sa.showLoading();let r=this.capitalizar(this.especialidadNueva.value.trim());yield this.e.guardarEspecialidad(r),this.especialidadNueva.setValue(""),this.especialidades=yield this.e.obtenerEspecialidades(),this.sa.closeLoading()})}onToggleEspecialidad(r,i){let e=i.target.checked,s=this.especialidadesChecks,u=s.value??[];e?s.setValue([...u,r]):s.setValue(u.filter(S=>S!==r)),s.markAsTouched()}get email(){return this.form.get("email")}get password(){return this.form.get("password")}get nombre(){return this.form.get("nombre")}get apellido(){return this.form.get("apellido")}get dni(){return this.form.get("dni")}get edad(){return this.form.get("edad")}get imagen1(){return this.form.get("imagen1")}get perfil(){return this.form.get("perfil")}get captcha(){return this.form.get("captcha")}get obraSocial(){return this.formPaciente.get("obraSocial")}get imagen2(){return this.formPaciente.get("imagen2")}get especialidadNueva(){return this.formEspecialista.get("especialidadNueva")}get especialidadesChecks(){return this.formEspecialista.get("especialidadesChecks")}onFileSelected(r,i){let e=r.target.files[0];i==="imagen1"?this.imagen1.setValue(e):i==="imagen2"&&this.imagen2.setValue(e)}capitalizar(r){return r[0].toUpperCase()+r.slice(1).toLowerCase()}goTo(r){this.router.navigate([r])}static \u0275fac=function(i){return new(i||d)(f(F),f(I),f(V),f(L))};static \u0275cmp=N({type:d,selectors:[["app-registro"]],decls:74,vars:26,consts:[[1,"card-container"],[1,"titulo"],[1,"form-container",3,"formGroup"],[1,"input"],["type","text","placeholder","Tu nombre","formControlName","nombre"],["type","text","placeholder","Tu apellido","formControlName","apellido"],["type","text","placeholder","Tu dni","formControlName","dni"],["type","text","placeholder","Tu edad","formControlName","edad"],["type","email","placeholder","Tu correo","formControlName","email"],["type","password","placeholder","Contrase\xF1a","formControlName","password"],["type","file","accept","image/*",3,"change"],[1,"perfil-selector"],[1,"row","opciones"],["type","button",1,"btn-opcion-perfil",3,"click"],["src","assets/avatar-paciente.png","alt","Paciente"],["src","assets/avatar-especialista.png","alt","Especialista"],[1,"row","mensaje-error"],["appCaptcha","","formControlName","captcha"],["type","button",1,"btn-1",3,"click"],[1,"registro-texto"],["type","button",1,"btn-registro",3,"click"],["type","text","placeholder","Obra Social","formControlName","obraSocial"],[1,"especialidades-lista"],[1,"chk-especialidad"],["type","text","placeholder","Nueva Especialidad","formControlName","especialidadNueva"],["type","button",1,"btn-1",3,"click","ngClass"],["type","checkbox",3,"change","value"]],template:function(i,e){i&1&&(t(0,"main",0)(1,"h2",1),l(2,"Registro de Usuario"),a(),t(3,"form",2)(4,"div",3)(5,"label"),l(6,"Nombre"),a(),p(7,"input",4),t(8,"small"),l(9," El nombre es obligatorio, solo puede contener letras y espacios. "),a()(),t(10,"div",3)(11,"label"),l(12,"Apellido"),a(),p(13,"input",5),t(14,"small"),l(15," El apellido es obligatorio, solo puede contener letras y espacios. "),a()(),t(16,"div",3)(17,"label"),l(18,"Dni"),a(),p(19,"input",6),t(20,"small"),l(21," El dni es obligatorio, debe contener 8 o 9 d\xEDgitos. "),a()(),t(22,"div",3)(23,"label"),l(24,"Edad"),a(),p(25,"input",7),t(26,"small"),l(27," La edad es obligatoria, debe ser mayor a 18 o menor a 120. "),a()(),t(28,"div",3)(29,"label"),l(30,"Correo Electr\xF3nico"),a(),p(31,"input",8),t(32,"small"),l(33," Ingresar un mail v\xE1lido. "),a()(),t(34,"div",3)(35,"label"),l(36,"Contrase\xF1a"),a(),p(37,"input",9),t(38,"small"),l(39," La contrase\xF1a debe contener un m\xEDnimo de 6 caracteres. "),a()(),t(40,"div",3)(41,"label"),l(42,"Imagen de perfil"),a(),t(43,"input",10),g("change",function(u){return e.onFileSelected(u,"imagen1"),e.imagen1==null?null:e.imagen1.markAsTouched()}),a(),t(44,"small"),l(45," La imagen es obligatoria. "),a()(),t(46,"div",11)(47,"div",12)(48,"button",13),g("click",function(){return e.perfil==null?null:e.perfil.setValue("paciente")}),p(49,"img",14),t(50,"span"),l(51,"Paciente"),a()(),t(52,"button",13),g("click",function(){return e.perfil==null?null:e.perfil.setValue("especialista")}),p(53,"img",15),t(54,"span"),l(55,"Especialista"),a()()(),t(56,"div",16)(57,"small"),l(58," Debe seleccionar un perfil. "),a()()()(),w(59,K,13,5,"form",2),w(60,W,17,8,"form",2),t(61,"div",2)(62,"div",3)(63,"label"),l(64,"Captcha"),a(),p(65,"div",17),t(66,"small"),l(67," Completar el captcha. "),a()()(),t(68,"button",18),g("click",function(){return e.registrarUsuario()}),l(69,"Registrarse"),a(),t(70,"p",19),l(71," \xBFYa tenes cuenta? "),t(72,"button",20),g("click",function(){return e.goTo("login")}),l(73,"Ingresar"),a()()()),i&2&&(n(3),h("formGroup",e.form),n(5),c("visibility",e.nombre!=null&&e.nombre.invalid&&(e.nombre!=null&&e.nombre.touched)?"visible":"hidden"),n(6),c("visibility",e.apellido!=null&&e.apellido.invalid&&(e.apellido!=null&&e.apellido.touched)?"visible":"hidden"),n(6),c("visibility",e.dni!=null&&e.dni.invalid&&(e.dni!=null&&e.dni.touched)?"visible":"hidden"),n(6),c("visibility",e.edad!=null&&e.edad.invalid&&(e.edad!=null&&e.edad.touched)?"visible":"hidden"),n(6),c("visibility",e.email!=null&&e.email.invalid&&(e.email!=null&&e.email.touched)?"visible":"hidden"),n(6),c("visibility",e.password!=null&&e.password.invalid&&(e.password!=null&&e.password.touched)?"visible":"hidden"),n(6),c("visibility",e.imagen1!=null&&e.imagen1.invalid&&(e.imagen1!=null&&e.imagen1.touched)?"visible":"hidden"),n(4),k("selected",(e.perfil==null?null:e.perfil.value)==="paciente"),n(4),k("selected",(e.perfil==null?null:e.perfil.value)==="especialista"),n(5),c("visibility",e.perfil!=null&&e.perfil.invalid&&(e.perfil!=null&&e.perfil.touched)?"visible":"hidden"),n(2),P((e.perfil==null?null:e.perfil.value)==="paciente"?59:-1),n(),P((e.perfil==null?null:e.perfil.value)==="especialista"?60:-1),n(),h("formGroup",e.form),n(5),c("visibility",e.captcha!=null&&e.captcha.invalid&&(e.captcha!=null&&e.captcha.touched)?"visible":"hidden"))},dependencies:[j,z,q,G,D,Z,U,$,O,M,B],styles:[".perfil-selector[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.row.opciones[_ngcontent-%COMP%]{display:flex;justify-content:space-around;gap:1rem}.btn-opcion-perfil[_ngcontent-%COMP%]{background-color:var(--c-primary-dark);border:2px solid transparent;border-radius:.75rem;padding:1rem;cursor:pointer;color:#b2dfdb;font-weight:500;transition:all .2s ease-in-out;width:10rem;text-align:center}.btn-opcion-perfil[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;margin-bottom:.5rem;border-radius:.5rem}.btn-opcion-perfil[_ngcontent-%COMP%]:hover{border-color:var(--c-primary);transform:scale(1.03)}.btn-opcion-perfil.selected[_ngcontent-%COMP%]{border-color:var(--c-accent);box-shadow:0 0 10px #ffc10766}.row.mensaje-error[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f44336;margin-top:.5rem;text-align:center}.registro-texto[_ngcontent-%COMP%]{text-align:center;color:var(--c-primary-light)}.registro-texto[_ngcontent-%COMP%]   .btn-registro[_ngcontent-%COMP%]{margin-left:.3rem}.btn-registro[_ngcontent-%COMP%]{background:none;color:var(--c-accent);border:none;font-size:.9rem;font-weight:400;cursor:pointer;padding:0;transition:color .2s ease-in-out}.btn-registro[_ngcontent-%COMP%]:hover{color:#e0a800;text-decoration:underline}.especialidades-lista[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;align-items:center}.chk-especialidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;min-width:140px;white-space:nowrap;color:var(--c-primary-light)}.deshabilitado[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;cursor:not-allowed}"]})};export{H as Registro};
