import{a as z}from"./chunk-BFNE2Y55.js";import{a as A}from"./chunk-GI4JLFKI.js";import{h as V,n as j,o as N,p as U}from"./chunk-Y4FSZ7ZR.js";import"./chunk-LJ5XHLMQ.js";import{Bb as S,Cb as T,Db as F,Ea as M,Fa as s,Ib as $,Kb as L,Na as u,Ra as D,S as P,W as k,aa as _,ba as b,db as O,eb as g,fb as f,kb as a,lb as n,mb as y,nb as v,ob as I,sb as x,tb as l,xb as E,zb as d}from"./chunk-MJUOTLSQ.js";import{h as p}from"./chunk-FK42CRUA.js";var C=class t{constructor(i){this.db=i}crearTurno(i){return p(this,null,function*(){let{error:e}=yield this.db.cliente.from("turnos").insert([i]);if(e)throw new Error(e.message);return!0})}static \u0275fac=function(e){return new(e||t)(k(j))};static \u0275prov=P({token:t,factory:t.\u0275fac,providedIn:"root"})};var H=(t,i)=>i.id,G=(t,i)=>i.dia_semana,J=(t,i)=>i.fecha;function Q(t,i){if(t&1){let e=v();a(0,"button",14),x("click",function(){let c=_(e).$implicit,o=l();return b(o.seleccionarEspecialidad(c))}),y(1,"div",15),a(2,"span",16),d(3),n()()}if(t&2){let e=i.$implicit,r=l();E("seleccionada",(r.especialidadSeleccionada==null?null:r.especialidadSeleccionada.id)===e.id),s(3),S(" ",e.nombre," ")}}function R(t,i){if(t&1){let e=v();a(0,"div",17),x("click",function(){let c=_(e).$implicit,o=l();return b(o.seleccionarProfesional(c))}),a(1,"div",18),y(2,"img",19),n(),a(3,"span",20),d(4),n()()}if(t&2){let e=i.$implicit,r=l();E("seleccionada",(r.profesionalSeleccionado==null?null:r.profesionalSeleccionado.id)===e.id),s(2),I("alt",F(e.nombre))("src",e.imagen_1_path,M),s(2),T("",e.nombre," ",e.apellido)}}function K(t,i){if(t&1){let e=v();a(0,"button",21),x("click",function(){let c=_(e).$implicit,o=l();return b(o.seleccionarDia(c))}),d(1),n()}if(t&2){let e=i.$implicit,r=l();E("seleccionado",r.diaSeleccionado===e.dia_semana),s(),S(" ",r.obtenerNombreDia(e.dia_semana)," ")}}function W(t,i){if(t&1){let e=v();a(0,"button",25),x("click",function(){let c=_(e).$implicit,o=l().$implicit,m=l();return b(m.seleccionarTurno(o.fecha,c))}),d(1),n()}if(t&2){let e=i.$implicit;s(),S(" ",e," ")}}function X(t,i){if(t&1&&(a(0,"div",13)(1,"h4",22),d(2),$(3,"date"),n(),a(4,"div",23),g(5,W,2,1,"button",24,O),n()()),t&2){let e=i.$implicit,r=l();s(2),T(" ",r.obtenerNombreDia(e.fecha.getDay()),": ",L(3,2,e.fecha,"dd/MM")," "),s(3),f(e.turnos)}}var Y=class t{constructor(i,e,r,c,o){this.u=i;this.sa=e;this.he=r;this.e=c;this.t=o}especialidades=[];especialidadSeleccionada=null;profesionales=[];profesionalSeleccionado=null;diaSeleccionado=null;turnosSemanas=[];ngOnInit(){return p(this,null,function*(){this.sa.showLoading(),this.especialidades=yield this.e.obtenerEspecialidades(),this.sa.closeLoading()})}seleccionarEspecialidad(i){return p(this,null,function*(){console.log(i.nombre),this.sa.showLoading(),this.especialidadSeleccionada=i,this.profesionales=yield this.u.obtenerUsuariosEspecialistasPorEspecialidad(this.especialidadSeleccionada.id),this.sa.closeLoading()})}seleccionarProfesional(i){return p(this,null,function*(){console.log(i.nombre),this.sa.showLoading(),this.profesionalSeleccionado=i,this.sa.closeLoading()})}seleccionarDia(i){return p(this,null,function*(){console.log("D\xEDa seleccionado:",i.dia_semana),this.sa.showLoading(),this.diaSeleccionado=i.dia_semana;let e=new Date,r=[];for(let o=1;o<=15;o++){let m=new Date;m.setDate(e.getDate()+o),m.getDay()===i.dia_semana&&r.push(m)}let c=(o,m)=>{let w=[];for(let h=o;h<m;h++)w.push(`${h}:00`),w.push(`${h}:30`);return w};this.turnosSemanas=r.slice(0,2).map(o=>({fecha:o,turnos:c(Number(i.hora_inicio),Number(i.hora_fin))})),console.log(this.turnosSemanas),this.sa.closeLoading()})}seleccionarTurno(i,e){return p(this,null,function*(){if(!(yield this.sa.confirmarAccion("\xBFConfirmar turno?",`\xBFQuer\xE9s reservar el turno del ${i.toLocaleDateString()} a las ${e}?`)))return;this.sa.showLoading();let c={dia:i,hora:e,id_paciente:this.u.userId,id_especialista:this.profesionalSeleccionado.id,id_especialidad:this.especialidadSeleccionada.id,estado:"pendiente"},o=yield this.t.crearTurno(c);this.sa.closeLoading(),o?this.sa.showAlertSuccess("Turno reservado","Tu turno fue registrado correctamente."):this.sa.showAlertError("Error","No se pudo registrar el turno.")})}obtenerNombreDia(i){return["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"][i]??""}get diasDisponibles(){return this.profesionalSeleccionado?.horarios_especialista?.filter(i=>i.activo)||[]}static \u0275fac=function(e){return new(e||t)(u(U),u(A),u(z),u(N),u(C))};static \u0275cmp=D({type:t,selectors:[["app-sacar-turno"]],decls:26,vars:0,consts:[[1,"card-container"],[1,"titulo"],[1,"especialidades"],[1,"sub-titulo"],[1,"especialidades-grid"],["type","button",1,"especialidad-card",3,"seleccionada"],[1,"profesionales"],[1,"profesionales-grid"],[1,"profesional-card",3,"seleccionada"],[1,"turno-dias"],[1,"dias-grid"],["type","button",1,"dia-card",3,"seleccionado"],[1,"turnos-container"],[1,"turnos-semana"],["type","button",1,"especialidad-card",3,"click"],[1,"especialidad-icono-placeholder"],[1,"especialidad-nombre"],[1,"profesional-card",3,"click"],[1,"profesional-foto"],[3,"src","alt"],[1,"profesional-nombre"],["type","button",1,"dia-card",3,"click"],[1,"turno-dia"],[1,"turnos-grid"],["type","button",1,"turno-buttons"],["type","button",1,"turno-buttons",3,"click"]],template:function(e,r){e&1&&(a(0,"main",0)(1,"h2",1),d(2,"Sacar Turno"),n(),a(3,"div",2)(4,"h6",3),d(5,"Eleg\xED una especialidad"),n(),a(6,"div",4),g(7,Q,4,3,"button",5,H),n()(),a(9,"div",6)(10,"h6",3),d(11,"Eleg\xED un profesional"),n(),a(12,"div",7),g(13,R,5,7,"div",8,H),n()(),a(15,"div",9)(16,"h6",3),d(17,"Eleg\xED un dia"),n(),a(18,"div",10),g(19,K,2,3,"button",11,G),n()(),a(21,"div",12)(22,"h3",3),d(23,"Turnos disponibles"),n(),g(24,X,7,5,"div",13,J),n()()),e&2&&(s(7),f(r.especialidades),s(6),f(r.profesionales),s(6),f(r.diasDisponibles),s(5),f(r.turnosSemanas))},dependencies:[V],styles:[".card-container[_ngcontent-%COMP%]{max-width:80%}.especialidades-grid[_ngcontent-%COMP%]{display:flex;gap:.3rem;justify-items:center;margin-bottom:.5rem;border-bottom:2px solid #51db84;padding-bottom:1.5rem;padding-top:.5rem;gap:1rem}.especialidad-card[_ngcontent-%COMP%]{max-width:40%;max-height:40%;border-radius:10px;border:2px solid var(--c-primary-dark);background:var(--c-primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease-in-out;padding:.3rem}.especialidad-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 3px 6px #00000026}.especialidad-card.seleccionada[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.especialidad-icono-placeholder[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background-color:#d9d9d9}.especialidad-nombre[_ngcontent-%COMP%]{font-weight:600;color:var(--c-neutral);text-align:center;font-size:.9rem}.profesionales-grid[_ngcontent-%COMP%]{display:flex;gap:.3rem;align-items:center;justify-items:center;flex-direction:column;margin-bottom:.5rem;border-bottom:2px solid #51db84;padding-bottom:1.5rem;padding-top:.5rem;gap:1rem}.profesional-card[_ngcontent-%COMP%]{max-width:100%;max-height:20%;border-radius:10px;border:2px solid var(--c-primary-dark);background:var(--c-primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease-in-out;padding:.3rem}.profesional-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 3px 6px #00000026}.profesional-card.seleccionada[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.profesional-foto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;background-color:#d9d9d9}.profesional-nombre[_ngcontent-%COMP%]{font-weight:600;color:var(--c-neutral);text-align:center;font-size:.9rem}.dias-grid[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}.dia-card[_ngcontent-%COMP%]{border:2px solid var(--c-primary-dark);border-radius:8px;background:var(--c-primary);color:var(--c-neutral);cursor:pointer;transition:all .2s ease-in-out;font-size:1rem}.dia-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.dia-card.seleccionado[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.turnos-container[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:2px solid var(--c-accent)}.turnos-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.3rem}.turnos-semana[_ngcontent-%COMP%]{margin-bottom:1.5rem}.turno-buttons[_ngcontent-%COMP%]{border:2px solid var(--c-primary-dark);border-radius:8px;background:var(--c-primary);color:var(--c-neutral);cursor:pointer;transition:all .2s ease-in-out;font-size:.7rem;font-weight:600}.turno-buttons[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:var(--c-accent)}.turno-dia[_ngcontent-%COMP%]{color:var(--c-primary-light);font-size:.9rem}"]})};export{Y as SacarTurno};
