import{a as j}from"./chunk-2QVV2HUC.js";import{a as N}from"./chunk-ADK3ENQO.js";import{h as $,o as I,p as L,q as V}from"./chunk-OCRCOVDF.js";import"./chunk-LJ5XHLMQ.js";import{Ab as k,Eb as x,Fb as l,Ka as T,La as s,Nb as E,Pb as d,Rb as S,Sb as w,Tb as O,Va as u,Yb as D,Za as M,_b as F,da as _,ea as b,mb as P,nb as g,ob as f,tb as a,ub as n,vb as y,zb as v}from"./chunk-LG46M2DO.js";import{h as p}from"./chunk-FK42CRUA.js";var U=(r,e)=>e.id,z=(r,e)=>e.dia_semana,H=(r,e)=>e.fecha;function Y(r,e){if(r&1){let i=v();a(0,"button",14),x("click",function(){let c=_(i).$implicit,o=l();return b(o.seleccionarEspecialidad(c))}),y(1,"div",15),a(2,"span",16),d(3),n()()}if(r&2){let i=e.$implicit,t=l();E("seleccionada",(t.especialidadSeleccionada==null?null:t.especialidadSeleccionada.id)===i.id),s(3),S(" ",i.nombre," ")}}function q(r,e){if(r&1){let i=v();a(0,"div",17),x("click",function(){let c=_(i).$implicit,o=l();return b(o.seleccionarProfesional(c))}),a(1,"div",18),y(2,"img",19),n(),a(3,"span",20),d(4),n()()}if(r&2){let i=e.$implicit,t=l();E("seleccionada",(t.profesionalSeleccionado==null?null:t.profesionalSeleccionado.id)===i.id),s(2),k("alt",O(i.nombre))("src",i.imagen_1_path,T),s(2),w("",i.nombre," ",i.apellido)}}function B(r,e){if(r&1){let i=v();a(0,"button",21),x("click",function(){let c=_(i).$implicit,o=l();return b(o.seleccionarDia(c))}),d(1),n()}if(r&2){let i=e.$implicit,t=l();E("seleccionado",t.diaSeleccionado===i.dia_semana),s(),S(" ",t.obtenerNombreDia(i.dia_semana)," ")}}function G(r,e){if(r&1){let i=v();a(0,"button",25),x("click",function(){let c=_(i).$implicit,o=l().$implicit,m=l();return b(m.seleccionarTurno(o.fecha,c))}),d(1),n()}if(r&2){let i=e.$implicit;s(),S(" ",i," ")}}function J(r,e){if(r&1&&(a(0,"div",13)(1,"h4",22),d(2),D(3,"date"),n(),a(4,"div",23),g(5,G,2,1,"button",24,P),n()()),r&2){let i=e.$implicit,t=l();s(2),w(" ",t.obtenerNombreDia(i.fecha.getDay()),": ",F(3,2,i.fecha,"dd/MM")," "),s(3),f(i.turnos)}}var A=class r{constructor(e,i,t,c,o){this.u=e;this.sa=i;this.he=t;this.e=c;this.t=o}especialidades=[];especialidadSeleccionada=null;profesionales=[];profesionalSeleccionado=null;diaSeleccionado=null;turnosSemanas=[];ngOnInit(){return p(this,null,function*(){this.sa.showLoading(),this.especialidades=yield this.e.obtenerEspecialidades(),this.sa.closeLoading()})}seleccionarEspecialidad(e){return p(this,null,function*(){console.log(e.nombre),this.sa.showLoading(),this.especialidadSeleccionada=e,this.profesionales=yield this.u.obtenerUsuariosEspecialistasPorEspecialidad(this.especialidadSeleccionada.id),this.sa.closeLoading()})}seleccionarProfesional(e){return p(this,null,function*(){console.log(e.nombre),this.sa.showLoading(),this.profesionalSeleccionado=e,this.sa.closeLoading()})}seleccionarDia(e){return p(this,null,function*(){console.log("D\xEDa seleccionado:",e.dia_semana),this.sa.showLoading(),this.diaSeleccionado=e.dia_semana;let i=new Date,t=[];for(let o=1;o<=15;o++){let m=new Date;m.setDate(i.getDate()+o),m.getDay()===e.dia_semana&&t.push(m)}let c=(o,m)=>{let C=[];for(let h=o;h<m;h++)C.push(`${h}:00`),C.push(`${h}:30`);return C};this.turnosSemanas=t.slice(0,2).map(o=>({fecha:o,turnos:c(Number(e.hora_inicio),Number(e.hora_fin))})),console.log(this.turnosSemanas),this.sa.closeLoading()})}seleccionarTurno(e,i){return p(this,null,function*(){if(!(yield this.sa.confirmarAccion("\xBFConfirmar turno?",`\xBFQuer\xE9s reservar el turno del ${e.toLocaleDateString()} a las ${i}?`)))return;this.sa.showLoading();let c={dia:e,hora:i,id_paciente:this.u.userId,id_especialista:this.profesionalSeleccionado.id,id_especialidad:this.especialidadSeleccionada.id,estado:"pendiente"},o=yield this.t.crearTurno(c);this.sa.closeLoading(),o?this.sa.showAlertSuccess("Turno reservado","Tu turno fue registrado correctamente."):this.sa.showAlertError("Error","No se pudo registrar el turno.")})}obtenerNombreDia(e){return["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"][e]??""}get diasDisponibles(){return this.profesionalSeleccionado?.horarios_especialista?.filter(e=>e.activo)||[]}static \u0275fac=function(i){return new(i||r)(u(V),u(N),u(L),u(I),u(j))};static \u0275cmp=M({type:r,selectors:[["app-sacar-turno"]],decls:26,vars:0,consts:[[1,"card-container"],[1,"titulo"],[1,"especialidades"],[1,"sub-titulo"],[1,"especialidades-grid"],["type","button",1,"especialidad-card",3,"seleccionada"],[1,"profesionales"],[1,"profesionales-grid"],[1,"profesional-card",3,"seleccionada"],[1,"turno-dias"],[1,"dias-grid"],["type","button",1,"dia-card",3,"seleccionado"],[1,"turnos-container"],[1,"turnos-semana"],["type","button",1,"especialidad-card",3,"click"],[1,"especialidad-icono-placeholder"],[1,"especialidad-nombre"],[1,"profesional-card",3,"click"],[1,"profesional-foto"],[3,"src","alt"],[1,"profesional-nombre"],["type","button",1,"dia-card",3,"click"],[1,"turno-dia"],[1,"turnos-grid"],["type","button",1,"turno-buttons"],["type","button",1,"turno-buttons",3,"click"]],template:function(i,t){i&1&&(a(0,"main",0)(1,"h2",1),d(2,"Sacar Turno"),n(),a(3,"div",2)(4,"h6",3),d(5,"Eleg\xED una especialidad"),n(),a(6,"div",4),g(7,Y,4,3,"button",5,U),n()(),a(9,"div",6)(10,"h6",3),d(11,"Eleg\xED un profesional"),n(),a(12,"div",7),g(13,q,5,7,"div",8,U),n()(),a(15,"div",9)(16,"h6",3),d(17,"Eleg\xED un dia"),n(),a(18,"div",10),g(19,B,2,3,"button",11,z),n()(),a(21,"div",12)(22,"h3",3),d(23,"Turnos disponibles"),n(),g(24,J,7,5,"div",13,H),n()()),i&2&&(s(7),f(t.especialidades),s(6),f(t.profesionales),s(6),f(t.diasDisponibles),s(5),f(t.turnosSemanas))},dependencies:[$],styles:[".card-container[_ngcontent-%COMP%]{max-width:80%}.especialidades-grid[_ngcontent-%COMP%]{display:flex;gap:.3rem;justify-items:center;margin-bottom:.5rem;border-bottom:2px solid #51db84;padding-bottom:1.5rem;padding-top:.5rem;gap:1rem}.especialidad-card[_ngcontent-%COMP%]{max-width:40%;max-height:40%;border-radius:10px;border:2px solid var(--c-primary-dark);background:var(--c-primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease-in-out;padding:.3rem}.especialidad-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 3px 6px #00000026}.especialidad-card.seleccionada[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.especialidad-icono-placeholder[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background-color:#d9d9d9}.especialidad-nombre[_ngcontent-%COMP%]{font-weight:600;color:var(--c-neutral);text-align:center;font-size:.9rem}.profesionales-grid[_ngcontent-%COMP%]{display:flex;gap:.3rem;align-items:center;justify-items:center;flex-direction:column;margin-bottom:.5rem;border-bottom:2px solid #51db84;padding-bottom:1.5rem;padding-top:.5rem;gap:1rem}.profesional-card[_ngcontent-%COMP%]{max-width:100%;max-height:20%;border-radius:10px;border:2px solid var(--c-primary-dark);background:var(--c-primary);display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease-in-out;padding:.3rem}.profesional-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 3px 6px #00000026}.profesional-card.seleccionada[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.profesional-foto[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;background-color:#d9d9d9}.profesional-nombre[_ngcontent-%COMP%]{font-weight:600;color:var(--c-neutral);text-align:center;font-size:.9rem}.dias-grid[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;margin-top:1rem}.dia-card[_ngcontent-%COMP%]{border:2px solid var(--c-primary-dark);border-radius:8px;background:var(--c-primary);color:var(--c-neutral);cursor:pointer;transition:all .2s ease-in-out;font-size:1rem}.dia-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.dia-card.seleccionado[_ngcontent-%COMP%]{border-color:var(--c-accent);background-color:var(--c-primary-dark)}.turnos-container[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:2px solid var(--c-accent)}.turnos-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.3rem}.turnos-semana[_ngcontent-%COMP%]{margin-bottom:1.5rem}.turno-buttons[_ngcontent-%COMP%]{border:2px solid var(--c-primary-dark);border-radius:8px;background:var(--c-primary);color:var(--c-neutral);cursor:pointer;transition:all .2s ease-in-out;font-size:.7rem;font-weight:600}.turno-buttons[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:var(--c-accent)}.turno-dia[_ngcontent-%COMP%]{color:var(--c-primary-light);font-size:.9rem}"]})};export{A as SacarTurno};
