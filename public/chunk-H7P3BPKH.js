import{a as U,b as j,c as M,d as z,e as $,f as P,g as p,h as R,i as B,j as J,k as q,l as K,m as Q,n as W,o as X}from"./chunk-COGKNKTL.js";import{a as Y}from"./chunk-ADK3ENQO.js";import{e as L,i as D,p as V,q as T}from"./chunk-OCRCOVDF.js";import"./chunk-LJ5XHLMQ.js";import{Db as I,Fb as g,Ka as S,La as c,Nb as k,Pb as n,Qb as u,Sb as H,Tb as G,Va as f,Wb as h,Za as F,da as w,ea as E,jb as C,kb as x,lb as N,nb as b,ob as y,pb as m,qb as a,rb as t,sb as d,zb as A}from"./chunk-LG46M2DO.js";import{h as _}from"./chunk-FK42CRUA.js";var O=l=>({deshabilitado:l}),ie=(l,e)=>e.especialidades.id;function te(l,e){if(l&1&&(a(0,"li"),n(1),t()),l&2){let i=e.$implicit;c(),u(i.especialidades.nombre)}}function re(l,e){l&1&&(a(0,"p",21),n(1,"Horarios invalidos. El horario de fin debe ser mayor a inicio"),t())}function ae(l,e){if(l&1&&(a(0,"div",13)(1,"div",14)(2,"span",15),n(3),t(),a(4,"label",16)(5,"span"),n(6,"Atiende"),t(),d(7,"input",17),t(),a(8,"div",18)(9,"label"),n(10,"Desde"),t(),d(11,"input",19),t(),a(12,"div",18)(13,"label"),n(14,"Hasta"),t(),d(15,"input",20),t()(),C(16,re,2,0,"p",21),t()),l&2){let i,o,r,s=e.$implicit,v=e.$index,ee=g(2);k("activo",s.value.activo)("inactivo",!s.value.activo),m("formGroupName",v),c(3),u(ee.obtenerNombreDia(s.value.dia_semana)),c(8),m("ngClass",h(9,O,((i=s.get("activo"))==null?null:i.value)===!1)),c(4),m("ngClass",h(11,O,((o=s.get("activo"))==null?null:o.value)===!1)),c(),x((r=s.get("activo"))!=null&&r.value&&((r=s.get("hora_inicio"))!=null&&r.touched&&((r=s.get("hora_inicio"))!=null&&r.invalid)&&!((r=s.get("hora_inicio"))!=null&&r.value)||(r=s.get("hora_fin"))!=null&&r.touched&&((r=s.get("hora_fin"))!=null&&r.invalid)&&!((r=s.get("hora_fin"))!=null&&r.value)||s.getError("horarioInvalido")&&((r=s.get("activo"))!=null&&r.value))?16:-1)}}function oe(l,e){if(l&1){let i=A();a(0,"div",5)(1,"div",6)(2,"h4"),n(3,"Especialidades"),t(),a(4,"ul"),b(5,te,2,1,"li",null,ie),t()(),a(7,"div",7)(8,"h4"),n(9,"Horarios de Atenci\xF3n"),t(),a(10,"h5"),n(11,"Los horarios son:"),t(),a(12,"h6"),n(13,"Lunes a Viernes: 09:00 a 18:00 hs"),t(),a(14,"h6"),n(15,"S\xE1bados: 09:00 a 14:00 hs"),t(),a(16,"form",8)(17,"div",9),b(18,ae,17,13,"div",10,N),t(),a(20,"div",11)(21,"button",12),I("click",function(){w(i);let r=g();return E(r.guardarHorarios())}),n(22," Guardar cambios "),t()()()()()}if(l&2){let i=g();c(5),y(i.usuario.usuario_especialidad),c(11),m("formGroup",i.horariosForm),c(2),y(i.horariosArray.controls),c(3),m("ngClass",h(2,O,i.horariosForm.dirty===!1))}}var Z=class l{constructor(e,i,o){this.u=e;this.sa=i;this.he=o}usuario=null;horariosForm;ngOnInit(){return _(this,null,function*(){this.sa.showLoading(),this.usuario=yield this.u.obtenerUsuarioPorId(this.u.userId),this.sa.closeLoading(),this.usuario.perfil==="especialista"&&(this.horariosForm=new P({horarios:new Q(this.usuario.horarios_especialista.map(e=>new P({id:new p(e.id),dia_semana:new p(e.dia_semana),activo:new p(e.activo),hora_inicio:new p(e.hora_inicio,[M.pattern("^[0-9]{1,2}$")]),hora_fin:new p(e.hora_fin,[M.pattern("^[0-9]{1,2}$")])},{validators:this.validarHorarioGrupo})))}))})}guardarHorarios(){return _(this,null,function*(){if(this.horariosForm.invalid){yield this.sa.showAlertError("Error en los datos","Revise los datos ingresados");return}this.sa.showLoading();let e=this.horariosArray.controls.map(i=>i.value);try{yield this.he.actualizarHorariosEspecialista(e),this.sa.closeLoading(),yield this.sa.showAlertSuccess("Registro completado!","Los horarios fueron actualizados")}catch(i){this.sa.closeLoading(),yield this.sa.showAlertError("Error en el registro",i.message)}})}get horariosArray(){return this.horariosForm.get("horarios")}validarHorarioGrupo(e){let i=e.get("activo")?.value,o=Number(e.get("hora_inicio")?.value),r=Number(e.get("hora_fin")?.value),s=Number(e.get("dia_semana")?.value);if(!i)return null;if(isNaN(o)||isNaN(r))return{horarioInvalido:!0};let v=s===6?14:18;return o<9||r>v||r<=o?{horarioInvalido:!0}:null}capitalizar(e){return e[0].toUpperCase()+e.slice(1).toLowerCase()}obtenerNombreDia(e){return["Domingo","Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado"][e]??""}static \u0275fac=function(i){return new(i||l)(f(T),f(Y),f(V))};static \u0275cmp=F({type:l,selectors:[["app-mi-perfil"]],decls:13,vars:8,consts:[[1,"card-container"],[1,"titulo-perfil"],[1,"perfil-header"],[1,"perfil-foto",3,"src","alt"],[1,"perfil-datos"],[1,"perfil-especialista"],[1,"perfil-especialista-header"],[1,"perfil-especialista-horarios"],[3,"formGroup"],["formArrayName","horarios",1,"lista-horarios"],[1,"horario-item",3,"formGroupName","activo","inactivo"],[1,"especialista-botones"],[1,"btn-1",3,"click","ngClass"],[1,"horario-item",3,"formGroupName"],[1,"horario-fila"],[1,"dia"],[1,"check-atiende"],["type","checkbox","formControlName","activo"],[1,"input"],["formControlName","hora_inicio",3,"ngClass"],["formControlName","hora_fin",3,"ngClass"],[1,"error-msg"]],template:function(i,o){i&1&&(a(0,"main",0)(1,"h2",1),n(2,"Mi Perfil"),t(),a(3,"div",2),d(4,"img",3),a(5,"div",4)(6,"h3"),n(7),t(),a(8,"p"),n(9),t(),a(10,"p"),n(11),t()()(),C(12,oe,23,4,"div",5),t()),i&2&&(c(4),m("alt",G(o.usuario.nombre))("src",o.usuario.imagen_1_path,S),c(3),H("",o.capitalizar(o.usuario.nombre)," ",o.usuario.apellido),c(2),u(o.usuario.email),c(2),u(o.capitalizar(o.usuario.perfil)),c(),x(o.usuario.perfil==="especialista"?12:-1))},dependencies:[D,L,W,R,j,U,z,$,X,B,K,J,q],styles:["[_nghost-%COMP%]     .card-container{width:400vh}.titulo-perfil[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;color:var(--c-accent)}.perfil-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;border-bottom:1px solid var(--c-primary-dark);padding-bottom:1rem}.perfil-foto[_ngcontent-%COMP%]{width:120px;height:120px;object-fit:cover;border-radius:50%;border:3px solid var(--c-primary)}.perfil-datos[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--c-primary-light)}.perfil-datos[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;color:var(--c-accent)}.perfil-especialista-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.25rem;border-bottom:1px solid var(--c-primary-dark)}.perfil-especialista[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:.5rem;color:var(--c-primary)}.perfil-especialista[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{color:var(--c-accent)}.perfil-especialista[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{color:var(--c-primary-light)}.perfil-especialista[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:disc;padding-left:1.5rem;margin-top:.5rem}.perfil-especialista[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--c-primary-light)}.perfil-especialista-horarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.5rem}.lista-horarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.horario-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;background:var(--c-neutral);padding:.8rem 1rem;border-radius:6px;border-left:4px solid transparent;transition:background .3s ease,border-left-color .3s ease}.horario-fila[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:2rem}.perfil-especialista[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--c-accent)}.horario-item.activo[_ngcontent-%COMP%]{background-color:#00968826;border-left-color:var(--c-primary)}.horario-item.inactivo[_ngcontent-%COMP%]{background-color:#ff000026;border-left-color:#e57373}.fila-horario[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px}.dia[_ngcontent-%COMP%]{width:75px;font-weight:600;color:var(--c-primary-light)}.check-atiende[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.3rem;color:var(--c-primary)!important;font-weight:600}.input[_ngcontent-%COMP%]{width:100px;display:flex;flex-direction:row!important;align-items:flex-end!important;gap:10px}.horas-con-error[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center}.error-msg[_ngcontent-%COMP%]{color:#e57373;font-size:.85rem;margin:.25rem 0 0 .25rem}.especialista-botones[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:.5rem}.deshabilitado[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;cursor:not-allowed}"]})};export{Z as MiPerfil};
