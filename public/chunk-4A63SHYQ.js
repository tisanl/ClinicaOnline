import{b as I,c as o,d as q,e as D,f as S,g as m,h as G,i as z,l as U,n as $,o as j}from"./chunk-TMNQLGQR.js";import{a as Z}from"./chunk-GI4JLFKI.js";import{e as F}from"./chunk-IV7ENO7Y.js";import{e as M,i as O,o as V,p as L}from"./chunk-Y4FSZ7ZR.js";import"./chunk-LJ5XHLMQ.js";import{Ab as R,Fa as r,Gb as A,Na as f,Ra as N,aa as _,ab as C,ba as E,bb as P,eb as T,fb as x,gb as v,hb as t,ib as l,jb as u,nb as w,rb as g,tb as h,wb as c,xb as k,zb as a}from"./chunk-MJUOTLSQ.js";import{h as b}from"./chunk-FK42CRUA.js";var H=d=>({deshabilitado:d}),Y=(d,n)=>n.id;function J(d,n){if(d&1){let i=w();t(0,"form",2)(1,"div",3)(2,"label"),a(3,"Obra Social"),l(),u(4,"input",20),t(5,"small"),a(6," La obra social es obligatoria. "),l()(),t(7,"div",3)(8,"label"),a(9,"Imagen 2"),l(),t(10,"input",10),g("change",function(s){_(i);let p=h();return p.onFileSelected(s,"imagen2"),E(p.imagen2==null?null:p.imagen2.markAsTouched())}),l(),t(11,"small"),a(12," La imagen es obligatoria. "),l()()()}if(d&2){let i=h();v("formGroup",i.formPaciente),r(5),c("visibility",i.obraSocial!=null&&i.obraSocial.invalid&&(i.obraSocial!=null&&i.obraSocial.touched)?"visible":"hidden"),r(6),c("visibility",i.imagen2!=null&&i.imagen2.invalid&&(i.imagen2!=null&&i.imagen2.touched)?"visible":"hidden")}}function K(d,n){if(d&1){let i=w();t(0,"label",22)(1,"input",25),g("change",function(s){let p=_(i).$implicit,y=h(2);return E(y.onToggleEspecialidad(p.id,s))}),l(),t(2,"span"),a(3),l()()}if(d&2){let i=n.$implicit;r(),v("value",i.id),r(2),R(i.nombre)}}function Q(d,n){if(d&1){let i=w();t(0,"form",2)(1,"div",3)(2,"label"),a(3,"Especialidades"),l(),t(4,"div",21),T(5,K,4,2,"label",22,Y),l(),t(7,"small"),a(8," Debe seleccionar al menos una especialidad. "),l()(),t(9,"div",3)(10,"label"),a(11,"Nueva Especialidad"),l(),u(12,"input",23),t(13,"small"),a(14," La especialidad solo debe contener caracteres alfabeticos y espacios. "),l(),t(15,"button",24),g("click",function(){_(i);let s=h();return E(s.agregarEspecialidad())}),a(16," Agregar Especialidad "),l()()()}if(d&2){let i=h();v("formGroup",i.formEspecialista),r(5),x(i.especialidades),r(2),c("visibility",i.especialidadesChecks!=null&&i.especialidadesChecks.invalid&&(i.especialidadesChecks!=null&&i.especialidadesChecks.touched)?"visible":"hidden"),r(6),c("visibility",i.especialidadNueva!=null&&i.especialidadNueva.invalid?"visible":"hidden"),r(2),v("ngClass",A(6,H,!(i.especialidadNueva!=null&&i.especialidadNueva.value)||(i.especialidadNueva==null?null:i.especialidadNueva.invalid)))}}var B=class d{constructor(n,i,e,s){this.router=n;this.u=i;this.e=e;this.sa=s}form;formPaciente;formEspecialista;especialidades=[];ngOnInit(){return b(this,null,function*(){this.form=new S({email:new m(null,[o.required,o.email]),password:new m(null,[o.required,o.minLength(6)]),nombre:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),apellido:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),dni:new m(null,[o.required,o.pattern("^[0-9]{8,9}$")]),edad:new m(null,[o.required,o.pattern("^[0-9]{1,2}$"),o.min(18),o.max(120)]),imagen1:new m(null,o.required),perfil:new m(null,o.required)}),this.formPaciente=new S({obraSocial:new m(null,[o.required,o.pattern("^[a-zA-Z ]+$")]),imagen2:new m(null,o.required)}),this.formEspecialista=new S({especialidadesChecks:new m(null,o.required),especialidadNueva:new m(null,[o.pattern("^[a-zA-Z ]+$")])}),console.log(this.especialidadNueva),this.especialidades=yield this.e.obtenerEspecialidades()})}registrarUsuario(){return b(this,null,function*(){if(this.form.invalid&&(this.formPaciente.invalid||this.formEspecialista.invalid)){console.log(this.form),this.form.markAllAsTouched(),this.formPaciente.markAllAsTouched(),this.formEspecialista.markAllAsTouched(),yield this.sa.showAlertError("Error en los datos","Revise los datos ingresados");return}this.sa.showLoading();let n={id:"",created_at:null,email:this.email.value,nombre:this.capitalizar(this.nombre?.value),apellido:this.capitalizar(this.apellido?.value),dni:this.dni.value,edad:this.edad.value,obra_social:this.obraSocial.value,imagen_1_path:null,imagen_2_path:null,imagen_1_file:this.imagen1.value,imagen_2_file:this.imagen2.value,perfil:this.perfil.value,estado:null,historia_clinica_id:null,lista_especialidades_id:this.especialidadesChecks.value,usuario_especialidad:null,horarios_especialista:null};try{yield this.u.registrar(this.email?.value,this.password?.value,n),this.sa.closeLoading(),n.perfil=="especialista"?(this.u.logout(),yield this.sa.showAlertSuccess("Registro completado!","Seras enviado al Login. Recorda validar tu mail antes de ingresar y que un Aministrador debe habilitarte")):yield this.sa.showAlertSuccess("Registro completado!","Seras enviado al Login. Recorda validar tu mail antes de ingresar"),this.goTo("login")}catch(i){this.sa.closeLoading(),yield this.sa.showAlertError("Error en el registro",i.message)}})}agregarEspecialidad(){return b(this,null,function*(){if(!this.especialidadNueva.value)return;this.sa.showLoading();let n=this.capitalizar(this.especialidadNueva.value.trim());yield this.e.guardarEspecialidad(n),this.especialidadNueva.setValue(""),this.especialidades=yield this.e.obtenerEspecialidades(),this.sa.closeLoading()})}onToggleEspecialidad(n,i){let e=i.target.checked,s=this.especialidadesChecks,p=s.value??[];e?s.setValue([...p,n]):s.setValue(p.filter(y=>y!==n)),s.markAsTouched()}get email(){return this.form.get("email")}get password(){return this.form.get("password")}get nombre(){return this.form.get("nombre")}get apellido(){return this.form.get("apellido")}get dni(){return this.form.get("dni")}get edad(){return this.form.get("edad")}get imagen1(){return this.form.get("imagen1")}get perfil(){return this.form.get("perfil")}get obraSocial(){return this.formPaciente.get("obraSocial")}get imagen2(){return this.formPaciente.get("imagen2")}get especialidadNueva(){return this.formEspecialista.get("especialidadNueva")}get especialidadesChecks(){return this.formEspecialista.get("especialidadesChecks")}onFileSelected(n,i){let e=n.target.files[0];i==="imagen1"?this.imagen1.setValue(e):i==="imagen2"&&this.imagen2.setValue(e)}capitalizar(n){return n[0].toUpperCase()+n.slice(1).toLowerCase()}goTo(n){this.router.navigate([n])}static \u0275fac=function(i){return new(i||d)(f(F),f(L),f(V),f(Z))};static \u0275cmp=N({type:d,selectors:[["app-registro"]],decls:67,vars:23,consts:[[1,"card-container"],[1,"titulo"],[1,"form-container",3,"formGroup"],[1,"input"],["type","text","placeholder","Tu nombre","formControlName","nombre"],["type","text","placeholder","Tu apellido","formControlName","apellido"],["type","text","placeholder","Tu dni","formControlName","dni"],["type","text","placeholder","Tu edad","formControlName","edad"],["type","email","placeholder","Tu correo","formControlName","email"],["type","password","placeholder","Contrase\xF1a","formControlName","password"],["type","file","accept","image/*",3,"change"],[1,"perfil-selector"],[1,"row","opciones"],["type","button",1,"btn-opcion-perfil",3,"click"],["src","assets/avatar-paciente.png","alt","Paciente"],["src","assets/avatar-especialista.png","alt","Especialista"],[1,"row","mensaje-error"],["type","button",1,"btn-1",3,"click"],[1,"registro-texto"],["type","button",1,"btn-registro",3,"click"],["type","text","placeholder","Obra Social","formControlName","obraSocial"],[1,"especialidades-lista"],[1,"chk-especialidad"],["type","text","placeholder","Nueva Especialidad","formControlName","especialidadNueva"],["type","button",1,"btn-1",3,"click","ngClass"],["type","checkbox",3,"change","value"]],template:function(i,e){i&1&&(t(0,"main",0)(1,"h2",1),a(2,"Registro de Usuario"),l(),t(3,"form",2)(4,"div",3)(5,"label"),a(6,"Nombre"),l(),u(7,"input",4),t(8,"small"),a(9," El nombre es obligatorio, solo puede contener letras y espacios. "),l()(),t(10,"div",3)(11,"label"),a(12,"Apellido"),l(),u(13,"input",5),t(14,"small"),a(15," El apellido es obligatorio, solo puede contener letras y espacios. "),l()(),t(16,"div",3)(17,"label"),a(18,"Dni"),l(),u(19,"input",6),t(20,"small"),a(21," El dni es obligatorio, debe contener 8 o 9 d\xEDgitos. "),l()(),t(22,"div",3)(23,"label"),a(24,"Edad"),l(),u(25,"input",7),t(26,"small"),a(27," La edad es obligatoria, debe ser mayor a 18 o menor a 120. "),l()(),t(28,"div",3)(29,"label"),a(30,"Correo Electr\xF3nico"),l(),u(31,"input",8),t(32,"small"),a(33," Ingresar un mail v\xE1lido. "),l()(),t(34,"div",3)(35,"label"),a(36,"Contrase\xF1a"),l(),u(37,"input",9),t(38,"small"),a(39," La contrase\xF1a debe contener un m\xEDnimo de 6 caracteres. "),l()(),t(40,"div",3)(41,"label"),a(42,"Imagen de perfil"),l(),t(43,"input",10),g("change",function(p){return e.onFileSelected(p,"imagen1"),e.imagen1==null?null:e.imagen1.markAsTouched()}),l(),t(44,"small"),a(45," La imagen es obligatoria. "),l()(),t(46,"div",11)(47,"div",12)(48,"button",13),g("click",function(){return e.perfil==null?null:e.perfil.setValue("paciente")}),u(49,"img",14),t(50,"span"),a(51,"Paciente"),l()(),t(52,"button",13),g("click",function(){return e.perfil==null?null:e.perfil.setValue("especialista")}),u(53,"img",15),t(54,"span"),a(55,"Especialista"),l()()(),t(56,"div",16)(57,"small"),a(58," Debe seleccionar un perfil. "),l()()()(),C(59,J,13,5,"form",2),C(60,Q,17,8,"form",2),t(61,"button",17),g("click",function(){return e.registrarUsuario()}),a(62,"Registrarse"),l(),t(63,"p",18),a(64," \xBFYa tenes cuenta? "),t(65,"button",19),g("click",function(){return e.goTo("login")}),a(66,"Ingresar"),l()()()),i&2&&(r(3),v("formGroup",e.form),r(5),c("visibility",e.nombre!=null&&e.nombre.invalid&&(e.nombre!=null&&e.nombre.touched)?"visible":"hidden"),r(6),c("visibility",e.apellido!=null&&e.apellido.invalid&&(e.apellido!=null&&e.apellido.touched)?"visible":"hidden"),r(6),c("visibility",e.dni!=null&&e.dni.invalid&&(e.dni!=null&&e.dni.touched)?"visible":"hidden"),r(6),c("visibility",e.edad!=null&&e.edad.invalid&&(e.edad!=null&&e.edad.touched)?"visible":"hidden"),r(6),c("visibility",e.email!=null&&e.email.invalid&&(e.email!=null&&e.email.touched)?"visible":"hidden"),r(6),c("visibility",e.password!=null&&e.password.invalid&&(e.password!=null&&e.password.touched)?"visible":"hidden"),r(6),c("visibility",e.imagen1!=null&&e.imagen1.invalid&&(e.imagen1!=null&&e.imagen1.touched)?"visible":"hidden"),r(4),k("selected",(e.perfil==null?null:e.perfil.value)==="paciente"),r(4),k("selected",(e.perfil==null?null:e.perfil.value)==="especialista"),r(5),c("visibility",e.perfil!=null&&e.perfil.invalid&&(e.perfil!=null&&e.perfil.touched)?"visible":"hidden"),r(2),P((e.perfil==null?null:e.perfil.value)==="paciente"?59:-1),r(),P((e.perfil==null?null:e.perfil.value)==="especialista"?60:-1))},dependencies:[$,G,I,q,D,j,z,U,O,M],styles:[".perfil-selector[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}.row.opciones[_ngcontent-%COMP%]{display:flex;justify-content:space-around;gap:1rem}.btn-opcion-perfil[_ngcontent-%COMP%]{background-color:var(--c-primary-dark);border:2px solid transparent;border-radius:.75rem;padding:1rem;cursor:pointer;color:#b2dfdb;font-weight:500;transition:all .2s ease-in-out;width:10rem;text-align:center}.btn-opcion-perfil[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80px;height:80px;margin-bottom:.5rem;border-radius:.5rem}.btn-opcion-perfil[_ngcontent-%COMP%]:hover{border-color:var(--c-primary);transform:scale(1.03)}.btn-opcion-perfil.selected[_ngcontent-%COMP%]{border-color:var(--c-accent);box-shadow:0 0 10px #ffc10766}.row.mensaje-error[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#f44336;margin-top:.5rem;text-align:center}.registro-texto[_ngcontent-%COMP%]{text-align:center;color:var(--c-primary-light)}.registro-texto[_ngcontent-%COMP%]   .btn-registro[_ngcontent-%COMP%]{margin-left:.3rem}.btn-registro[_ngcontent-%COMP%]{background:none;color:var(--c-accent);border:none;font-size:.9rem;font-weight:400;cursor:pointer;padding:0;transition:color .2s ease-in-out}.btn-registro[_ngcontent-%COMP%]:hover{color:#e0a800;text-decoration:underline}.especialidades-lista[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;align-items:center}.chk-especialidad[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;min-width:140px;white-space:nowrap;color:var(--c-primary-light)}.deshabilitado[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;cursor:not-allowed}"]})};export{B as Registro};
